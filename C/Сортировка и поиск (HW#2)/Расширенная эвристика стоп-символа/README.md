Существует модификация алгоритма Бойера-Мура, в которой эвристика стоп-символа расширена следующим образом:

**Расширенная эвристика стоп-символа.**

Встретив в строке  T символ  x = T![[k]](http://195.19.40.181:3386/tasks/iu9/algorithms_and_data_structures/sort_search_parse/extstop/text/extstop0x.png)  такой, что  x≠S![[i]](http://195.19.40.181:3386/tasks/iu9/algorithms_and_data_structures/sort_search_parse/extstop/text/extstop1x.png), мы можем расположить строку  S относительно строки  T так, что последнее вхождение  x в  S,  расположенное левее S![[i]](http://195.19.40.181:3386/tasks/iu9/algorithms_and_data_structures/sort_search_parse/extstop/text/extstop2x.png), окажется напротив  T![[k]](http://195.19.40.181:3386/tasks/iu9/algorithms_and_data_structures/sort_search_parse/extstop/text/extstop3x.png).

**Пример.**

(T![[2]](http://195.19.40.181:3386/tasks/iu9/algorithms_and_data_structures/sort_search_parse/extstop/text/extstop4x.png)  = a – стоп-символ)  

<table id="TBL-1" class="array" cellpadding="0" cellspacing="0"><colgroup id="TBL-1-1g"><col id="TBL-1-1"><col id="TBL-1-2"><col id="TBL-1-3"><col id="TBL-1-4"><col id="TBL-1-5"><col id="TBL-1-6"><col id="TBL-1-7"><col id="TBL-1-8"><col id="TBL-1-9"><col id="TBL-1-10"><col id="TBL-1-11"><col id="TBL-1-12"><col id="TBL-1-13"></colgroup><tbody><tr style="vertical-align:baseline;"><td style="white-space:nowrap; text-align:center;"><div class="td11">   </div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmti-12">0</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmti-12">1</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"> <span class="cmti-12">2  </span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmti-12">3</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmti-12">4</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmti-12">5</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmti-12">6</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmti-12">7</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmti-12">8</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmti-12">9</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">…</span></div></td>
</tr><tr style="vertical-align:baseline;"><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">T </span><span class="cmr-12">=</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">a</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">b</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"> <span class="underline"><span class="cmmi-12">a</span></span> </div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">a</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">b</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">a</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">b</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">a</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">c</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">b</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">…</span></div></td>
</tr><tr style="vertical-align:baseline;"><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">S </span><span class="cmr-12">=</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">c</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">a</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><img src="tasks/iu9/algorithms_and_data_structures/sort_search_parse/extstop/text/extstop5x.png" alt="⟨b⟩" style="display: inline-block; vertical-align: middle; height: 1em;"></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmbx-12">a</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmbx-12">b</span></div></td>
</tr><tr style="vertical-align:baseline;"><td style="white-space:nowrap; text-align:center;"><div class="td11">   </div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"> </div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">c</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"> <span class="underline"><span class="cmmi-12">a</span></span> </div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">b</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">a</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">b</span></div></td></tr><tr style="vertical-align:baseline;"><td style="white-space:nowrap; text-align:center;"><div class="td11"> </div></td> <td style="white-space:nowrap; text-align:center;"><div class="td11"></div></td> <td style="white-space:nowrap; text-align:center;"><div class="td11"> </div></td> <td style="white-space:nowrap; text-align:center;"><div class="td11"> </div></td> <td style="white-space:nowrap; text-align:center;"><div class="td11"> </div></td> <td style="white-space:nowrap; text-align:center;"><div class="td11"> </div></td> <td style="white-space:nowrap; text-align:center;"><div class="td11"> <span class="cmmi-12">. </span></div></td> <td style="white-space:nowrap; text-align:center;"><div class="td11"> <span class="cmmi-12">.</span></div></td><td style="white-space:nowrap; text-align:center;"><div class="td11"><span class="cmmi-12">.</span></div></td>
</tr></tbody></table>

Таблица  δ~1~  для эффективной реализации расширенной эвристики стоп-символа должна представлять собой матрицу размера  len![(S)](http://195.19.40.181:3386/tasks/iu9/algorithms_and_data_structures/sort_search_parse/extstop/text/extstop6x.png)  × size, где  size – размер алфавита. При неудачном сравнении символов  S![[i]](http://195.19.40.181:3386/tasks/iu9/algorithms_and_data_structures/sort_search_parse/extstop/text/extstop7x.png)  и  T![[k]](http://195.19.40.181:3386/tasks/iu9/algorithms_and_data_structures/sort_search_parse/extstop/text/extstop8x.png) алгоритм Бойера-Мура должен прочитать смещение для переменной  *k* из  δ~1~![[i,T [k]]](http://195.19.40.181:3386/tasks/iu9/algorithms_and_data_structures/sort_search_parse/extstop/text/extstop9x.png).

Составьте программу **extstop.c**, осуществляющую поиск первого вхождения подстроки  S в строку  T. В программе должен быть реализован вариант алгоритма Бойера-Мура, в котором не используется эвристика совпавшего суффикса, а эвристика стоп-символа расширена приведённым выше способом.

Строки  S и  T должны передаваться в программу через аргументы командной строки. Программа должна вывести в стандартный поток вывода индекс первого символа первого вхождения  S в  T. Если такого вхождения нет, программа должна вывести  len![(T)](http://195.19.40.181:3386/tasks/iu9/algorithms_and_data_structures/sort_search_parse/extstop/text/extstop10x.png).




